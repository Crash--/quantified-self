<mat-card *ngIf="event.getActivities().length > 1">
  <mat-card-content>
    <section>
      <app-activities-checkboxes [event]="event" (selectedActivities)="onSelectedActivities($event)">
      </app-activities-checkboxes>
    </section>
  </mat-card-content>
</mat-card>

<mat-card>
  <agm-map
    [fullscreenControl]="true"
    [mapTypeControl]="true"
    [scaleControl]="true"
    [fitBounds]="getBounds()">
    <agm-polyline
      *ngFor="let activity of this.selectedActivities;"
      [strokeColor]="eventColorService.getActivityColor(event, activity)"
      [strokeWeight]="4">
      <agm-polyline-point
        *ngFor="let point of event.getPointsWithPosition(null, null, [activity])"
        [latitude]="point.getPosition().latitudeDegrees"
        [longitude]="point.getPosition().longitudeDegrees">
      </agm-polyline-point>
    </agm-polyline>

    <agm-marker
      [iconUrl]="'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAiklEQVR42mNgQIAoIF4NxGegdCCSHAMzEC+NUlH5v9rF5f+ZoCAwHaig8B8oPhOmKC1NU/P//7Q0DByrqgpSGAtSdOCAry9WRXt9fECK9oIUPXwYFYVV0e2ICJCi20SbFAuyG5uiECUlkKIQmOPng3y30d0d7Lt1bm4w301jQAOgcNoIDad1yOEEAFm9fSv/VqtJAAAAAElFTkSuQmCC'"
      [latitude]="getStartPosition().latitudeDegrees"
      [longitude]="getStartPosition().longitudeDegrees">
      <agm-info-window
        [isOpen]="true"
        [disableAutoPan]="true"
        [latitude]="getStartPosition().latitudeDegrees"
        [longitude]="getStartPosition().longitudeDegrees">
        Start
      </agm-info-window>
    </agm-marker>
    <agm-marker
      *ngFor="let lap of getAllLaps(); let i = index;"
      (markerClick)="openLapMarkerInfoWindow(lap)"
      [iconUrl]="'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAiklEQVR42mNgQIAoIF4NxGegdCCSHAMzEC+NUlH5v9rF5f+ZoCAwHaig8B8oPhOmKC1NU/P//7Q0DByrqgpSGAtSdOCAry9WRXt9fECK9oIUPXwYFYVV0e2ICJCi20SbFAuyG5uiECUlkKIQmOPng3y30d0d7Lt1bm4w301jQAOgcNoIDad1yOEEAFm9fSv/VqtJAAAAAElFTkSuQmCC'"
      [latitude]="getLapEndPosition(lap).latitudeDegrees"
      [longitude]="getLapEndPosition(lap).longitudeDegrees">
      <agm-info-window
        [disableAutoPan]="true"
        [isOpen]="openedLapMarkerInfoWindow === lap"
        [latitude]="getLapEndPosition(lap).latitudeDegrees"
        [longitude]="getLapEndPosition(lap).longitudeDegrees">
        Lap {{ i +1 }}
        <mat-divider [inset]="true"></mat-divider>
        Start: {{lap.startDate.toLocaleTimeString()}}<br/>
        End: {{lap.endDate.toLocaleTimeString()}}<br/>
        Duration: {{ lap.getDuration().getDisplayValue() }} {{ lap.getDuration().getDisplayUnit() }}<br/>
        Distance: {{ lap.getDistance().getDisplayValue() }} {{ lap.getDistance().getDisplayUnit() }}<br/>
      </agm-info-window>
    </agm-marker>
  </agm-map>
</mat-card>
