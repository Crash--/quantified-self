<mat-card>
  <mat-grid-list [cols]="1" [rowHeight]="'fit'">
    <mat-grid-tile>
      <app-shade [isActive]="isLoading"></app-shade>
      <section>
        <section>
          <mat-icon class="suunto" svgIcon="suunto"></mat-icon>
          <p *ngIf="serviceTokens && serviceTokens.length">Up to 2 Suunto app accounts</p>
          <section>
            <p class="mat-small" *ngFor="let serviceToken of serviceTokens; let i = index;">
              {{ i+1 }}. Connected at {{serviceToken.dateCreated  | date:'medium'}}
              <mat-icon matTooltip="Account with username '{{ serviceToken.userName }}' is connected. NOTE: Sync happens for activities done after this date">
                info
              </mat-icon>
            </p>
            <p class="mat-small" *ngIf="!user || this.authService.isCurrentUserAnonymous()">For non anonymous users</p>

            <button class="big history" mat-flat-button *ngIf="serviceTokens && serviceTokens.length" color="accent" (click)="openHistoryImportForm()">History import</button>

            <button  [class.big]="(!user || this.authService.isCurrentUserAnonymous()) || (serviceTokens && (serviceTokens.length === 0 || serviceTokens.length > 1))"  mat-flat-button color="primary" [disabled]="!user || this.authService.isCurrentUserAnonymous()"
                    *ngIf="(!user || this.authService.isCurrentUserAnonymous()) || (serviceTokens && serviceTokens.length < 2)"
                    (click)="connectWithSuuntoApp($event)">{{ serviceTokens && (serviceTokens.length === 1) ? 'Connect another' : 'Connect' }}
            </button>
            <button  [class.big]="serviceTokens.length > 1" [class.margin-left]="serviceTokens.length <= 1" mat-flat-button color="warn" class="margin-left"
                    *ngIf="serviceTokens && serviceTokens.length"
                    (click)="deauthorizeSuuntoApp($event)">{{ serviceTokens && (serviceTokens.length > 1) ? 'Disconnect all' : 'Disconnect' }}
            </button>
          </section>
        </section>

        <section>
          <form [formGroup]="suuntoAppLinkFormGroup" (submit)="onSubmit()" autocomplete="off">
            <mat-form-field>
              <label>
                <input matInput placeholder="Link" formControlName="input">
              </label>
              <mat-hint>Paste a Suunto app link that is public</mat-hint>
              <mat-error *ngIf="hasError('input')">
                This cannot be empty
              </mat-error>
            </mat-form-field>

            <section>
              <button [class.big]="!user"  mat-flat-button color="primary" (click)="onSubmit()">Download</button>
              <button *ngIf="user" class="margin-left" mat-flat-button color="accent" (click)="onImportAndOpen()">Import and open</button>
            </section>
          </form>
        </section>
      </section>
    </mat-grid-tile>
  </mat-grid-list>
</mat-card>
